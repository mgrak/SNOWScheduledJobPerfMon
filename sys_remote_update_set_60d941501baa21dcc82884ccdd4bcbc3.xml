<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2023-04-27 18:43:21">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description>Scheduled Job to monitor the state of the sys_trigger table. If too many jobs are scheduled during produciton hours system performance can be affected and transactions could be dropped.</description>
<inserted/>
<name>MGRAK: Scheduled Jobs Performance Monitor v0.01</name>
<origin_sys_id/>
<parent display_value=""/>
<release_date/>
<remote_base_update_set display_value=""/>
<remote_parent_id/>
<remote_sys_id>c8b581141b6a21dcc82884ccdd4bcb62</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>mrakowski</sys_created_by>
<sys_created_on>2023-04-27 18:43:21</sys_created_on>
<sys_id>60d941501baa21dcc82884ccdd4bcbc3</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>mrakowski</sys_updated_by>
<sys_updated_on>2023-04-27 18:43:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sysevent_register_f9a7c5581b6a21dcc82884ccdd4bcb3e</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sysevent_register"><sysevent_register action="INSERT_OR_UPDATE"><caller_access/><description>Performance Alert Notificaiton.</description><event_name>mgrak.performance_alert</event_name><fired_by/><queue/><suffix/><sys_class_name>sysevent_register</sys_class_name><sys_created_by>mrakowski</sys_created_by><sys_created_on>2023-04-27 18:33:53</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>f9a7c5581b6a21dcc82884ccdd4bcb3e</sys_id><sys_mod_count>0</sys_mod_count><sys_name>mgrak.performance_alert</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sysevent_register_f9a7c5581b6a21dcc82884ccdd4bcb3e</sys_update_name><sys_updated_by>mrakowski</sys_updated_by><sys_updated_on>2023-04-27 18:33:53</sys_updated_on><table/></sysevent_register></record_update>]]></payload>
<payload_hash>200797279</payload_hash>
<remote_update_set display_value="MGRAK: Scheduled Jobs Performance Monitor v0.01">60d941501baa21dcc82884ccdd4bcbc3</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mrakowski</sys_created_by>
<sys_created_on>2023-04-27 18:43:21</sys_created_on>
<sys_id>20d941501baa21dcc82884ccdd4bcbc4</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>187c3fe44720000001</sys_recorded_at>
<sys_updated_by>mrakowski</sys_updated_by>
<sys_updated_on>2023-04-27 18:43:21</sys_updated_on>
<table/>
<target_name>mgrak.performance_alert</target_name>
<type>Event Registration</type>
<update_domain>global</update_domain>
<update_guid>75a7c5586e6a21dc02a7026acd028a40</update_guid>
<update_guid_history>75a7c5586e6a21dc02a7026acd028a40:200797279</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_4d3705181b6a21dcc82884ccdd4bcb64</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>mgrak.perf.mon.sys_trigger.record.count</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>mrakowski</sys_created_by><sys_created_on>2023-04-27 18:31:55</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>4d3705181b6a21dcc82884ccdd4bcb64</sys_id><sys_mod_count>0</sys_mod_count><sys_name>mgrak.perf.mon.sys_trigger.record.count</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_4d3705181b6a21dcc82884ccdd4bcb64</sys_update_name><sys_updated_by>mrakowski</sys_updated_by><sys_updated_on>2023-04-27 18:31:55</sys_updated_on><type>integer</type><value>250</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=4d3705181b6a21dcc82884ccdd4bcb64"/></record_update>]]></payload>
<payload_hash>-742193357</payload_hash>
<remote_update_set display_value="MGRAK: Scheduled Jobs Performance Monitor v0.01">60d941501baa21dcc82884ccdd4bcbc3</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mrakowski</sys_created_by>
<sys_created_on>2023-04-27 18:43:21</sys_created_on>
<sys_id>a0d941501baa21dcc82884ccdd4bcbc4</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>187c3fc77e50000001</sys_recorded_at>
<sys_updated_by>mrakowski</sys_updated_by>
<sys_updated_on>2023-04-27 18:43:21</sys_updated_on>
<table/>
<target_name>mgrak.perf.mon.sys_trigger.record.count</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>c1370518346a21dcd04499eece567b68</update_guid>
<update_guid_history>c1370518346a21dcd04499eece567b68:-742193357</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sysauto_script_5e4781581b6a21dcc82884ccdd4bcb2b</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sysauto_script"&gt;&lt;sysauto_script action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;business_calendar/&gt;&lt;condition/&gt;&lt;conditional&gt;false&lt;/conditional&gt;&lt;entered_time&gt;1970-01-01 00:00:00&lt;/entered_time&gt;&lt;name&gt;Perfomance monitor scheduled jobs past due (sys_trigger)&lt;/name&gt;&lt;offset/&gt;&lt;offset_type&gt;0&lt;/offset_type&gt;&lt;run_as/&gt;&lt;run_as_tz/&gt;&lt;run_dayofmonth&gt;1&lt;/run_dayofmonth&gt;&lt;run_dayofweek&gt;1&lt;/run_dayofweek&gt;&lt;run_period&gt;1970-01-01 01:00:00&lt;/run_period&gt;&lt;run_start&gt;2023-04-27 18:00:00&lt;/run_start&gt;&lt;run_time&gt;1970-01-01 08:00:00&lt;/run_time&gt;&lt;run_type&gt;periodically&lt;/run_type&gt;&lt;script&gt;&lt;![CDATA[var gdtNow = new GlideDateTime(); //GMT
var threeAM = (gdtNow + '').replace(/[0-9]{2}:[0-9]{2}:[0-9]{2}/g, '03:00:00'); //PST
var gdtThreeAM = new GlideDateTime(); //GMT
gdtThreeAM.setDisplayValue(threeAM); //use setDisplay to convert offset 3am PST to GMT
//Do not run between midnight and 3 am when large jobs are running
if (gdtNow.onOrAfter(gdtThreeAM)) {
	var ga = new GlideAggregate('sys_trigger');
	ga.addEncodedQuery('trigger_type!=2^ORtrigger_type=^next_action&lt;=javascript:gs.beginningOfLastMinute()^trigger_type!=9^ORtrigger_type=NULL');
	ga.addAggregate('COUNT');
	ga.query();
	ga.next();
	var count = parseInt(ga.getAggregate('COUNT'));
	var threshold = parseInt(gs.getProperty('mgrak.perf.mon.sys_trigger.record.count'));
	if (count &gt; threshold) {
		var eventInfo = 'Scheduled Jobs (sys_trigger) tables has over ' + count + ' records past next run time.&lt;br /&gt;';
		var details = '&lt;a href="/sys_trigger_list.do?sysparm_query=trigger_type!%3D2%5EORtrigger_type%3D%5Enext_action%3C%3Djavascript:gs.beginningOfLastMinute()%5Etrigger_type!%3D9%5EORtrigger_type%3DNULL%5EGROUPBYstate"&gt;records past due table&lt;/a&gt;&lt;br&gt;Monitor Threshold: ' + threshold;
		gs.eventQueue("pnmac.performance_alert", '', '', eventInfo, details.replace(/\n/g, "&lt;br /&gt;"));
	}
}]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sysauto_script&lt;/sys_class_name&gt;&lt;sys_created_by&gt;mrakowski&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-04-27 18:32:17&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;5e4781581b6a21dcc82884ccdd4bcb2b&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;Perfomance monitor scheduled jobs past due (sys_trigger)&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysauto_script_5e4781581b6a21dcc82884ccdd4bcb2b&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;mrakowski&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-04-27 18:37:20&lt;/sys_updated_on&gt;&lt;time_zone/&gt;&lt;upgrade_safe&gt;false&lt;/upgrade_safe&gt;&lt;/sysauto_script&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1250924186</payload_hash>
<remote_update_set display_value="MGRAK: Scheduled Jobs Performance Monitor v0.01">60d941501baa21dcc82884ccdd4bcbc3</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mrakowski</sys_created_by>
<sys_created_on>2023-04-27 18:43:21</sys_created_on>
<sys_id>a4d941501baa21dcc82884ccdd4bcbc3</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>187c40179270000001</sys_recorded_at>
<sys_updated_by>mrakowski</sys_updated_by>
<sys_updated_on>2023-04-27 18:43:21</sys_updated_on>
<table/>
<target_name>Perfomance monitor scheduled jobs past due (sys_trigger)</target_name>
<type>Scheduled Script Execution</type>
<update_domain>global</update_domain>
<update_guid>0578c5d8c06a21dc89abc7ab2e3178c5</update_guid>
<update_guid_history>0578c5d8c06a21dc89abc7ab2e3178c5:-1250924186,fb574118f66a21dc5d170bad3622743f:463561883</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sysevent_email_action_31894ddc1b6a21dcc82884ccdd4bcb36</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_email_action"&gt;&lt;sysevent_email_action action="INSERT_OR_UPDATE"&gt;&lt;action_insert&gt;false&lt;/action_insert&gt;&lt;action_update&gt;false&lt;/action_update&gt;&lt;active&gt;true&lt;/active&gt;&lt;advanced_condition/&gt;&lt;affected_field_on_event/&gt;&lt;category display_value="Performance Analytics" name="Performance Analytics"&gt;b69d02137f232200ee2e108c3ffa9151&lt;/category&gt;&lt;collection/&gt;&lt;condition/&gt;&lt;content_type&gt;text/html&lt;/content_type&gt;&lt;default_interval/&gt;&lt;description&gt;Notification for scripted peformance check alerts&lt;/description&gt;&lt;digest_from/&gt;&lt;digest_html/&gt;&lt;digest_reply_to/&gt;&lt;digest_separator_html&gt;&lt;![CDATA[&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;]]&gt;&lt;/digest_separator_html&gt;&lt;digest_separator_text&gt;&lt;![CDATA[\n--------------------------------------------------------------------------------\n]]&gt;&lt;/digest_separator_text&gt;&lt;digest_subject/&gt;&lt;digest_template/&gt;&lt;digest_text/&gt;&lt;digestable&gt;false&lt;/digestable&gt;&lt;event_name&gt;mgrak.performance_alert&lt;/event_name&gt;&lt;event_parm_1&gt;false&lt;/event_parm_1&gt;&lt;event_parm_2&gt;false&lt;/event_parm_2&gt;&lt;exclude_delegates&gt;false&lt;/exclude_delegates&gt;&lt;force_delivery&gt;false&lt;/force_delivery&gt;&lt;from/&gt;&lt;generation_type&gt;event&lt;/generation_type&gt;&lt;importance/&gt;&lt;include_attachments&gt;false&lt;/include_attachments&gt;&lt;item&gt;event.parm1&lt;/item&gt;&lt;item_table/&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;message/&gt;&lt;message_html&gt;&lt;![CDATA[&lt;table style="width: 100%;" border="0" cellspacing="0"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="font-weight: 100 !important;" width="100%"&gt;
&lt;h2 style="margin: 0; font-weight: 100 !important; font-size: large;"&gt;&lt;span style="color: #000000;"&gt;Performance Alert&lt;/span&gt;&lt;/h2&gt;
&lt;/td&gt;
&lt;td&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class="email-body"&gt;
&lt;div class="section"&gt;
&lt;div class="section-header" style="padding: 1rem; border-top: 1px solid #F0F0F2;"&gt;
&lt;h2 style="margin: 0; font-weight: 100; font-size: large;"&gt;Please perform the needful.&lt;/h2&gt;
&lt;div class="email-body"&gt;
&lt;div class="section"&gt;
&lt;div class="section-header" style="padding: 1rem; border-top: 1px solid #f0f0f2;"&gt;
&lt;h2 style="margin: 0px; font-weight: 100; font-size: large;"&gt;${event.parm1} Details&lt;/h2&gt;
&lt;/div&gt;
&lt;div class="section-body details" style="font-size: small; padding: 1rem;"&gt;
&lt;div class="row"&gt;
&lt;div class="col col-1" style="width: 150px; display: inline-block; padding: 0.25rem 0px; vertical-align: top;"&gt;
&lt;div class="label" style="font-weight: 600; padding-right: 1rem;"&gt;Details&lt;/div&gt;
&lt;/div&gt;
&lt;div class="col col-2" style="min-width: 230px; display: inline-block; padding: 0.25rem 0px; vertical-align: top;"&gt;
&lt;div&gt;${event.parm2}&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="row"&gt;&amp;nbsp;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;]]&gt;&lt;/message_html&gt;&lt;message_list/&gt;&lt;message_text/&gt;&lt;name&gt;Performance Alert&lt;/name&gt;&lt;omit_watermark&gt;false&lt;/omit_watermark&gt;&lt;order&gt;100&lt;/order&gt;&lt;push_message_only&gt;false&lt;/push_message_only&gt;&lt;recipient_fields/&gt;&lt;recipient_groups/&gt;&lt;recipient_users/&gt;&lt;reply_to/&gt;&lt;send_self&gt;false&lt;/send_self&gt;&lt;sms_alternate/&gt;&lt;style/&gt;&lt;subject&gt;Performance Alert:  ${event.parm1}&lt;/subject&gt;&lt;subscribable&gt;false&lt;/subscribable&gt;&lt;sys_class_name&gt;sysevent_email_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;mrakowski&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-04-27 18:42:05&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_id&gt;31894ddc1b6a21dcc82884ccdd4bcb36&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Performance Alert&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_email_action_31894ddc1b6a21dcc82884ccdd4bcb36&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;mrakowski&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-04-27 18:42:05&lt;/sys_updated_on&gt;&lt;sys_version&gt;2&lt;/sys_version&gt;&lt;template/&gt;&lt;type&gt;email&lt;/type&gt;&lt;weight&gt;0&lt;/weight&gt;&lt;/sysevent_email_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1196752023</payload_hash>
<remote_update_set display_value="MGRAK: Scheduled Jobs Performance Monitor v0.01">60d941501baa21dcc82884ccdd4bcbc3</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>mrakowski</sys_created_by>
<sys_created_on>2023-04-27 18:43:21</sys_created_on>
<sys_id>acd941501baa21dcc82884ccdd4bcbc3</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>187c405c52c0000001</sys_recorded_at>
<sys_updated_by>mrakowski</sys_updated_by>
<sys_updated_on>2023-04-27 18:43:21</sys_updated_on>
<table/>
<target_name>Performance Alert</target_name>
<type>Notification</type>
<update_domain>global</update_domain>
<update_guid>f9894ddc6e6a21dc13050b9b14668a39</update_guid>
<update_guid_history>f9894ddc6e6a21dc13050b9b14668a39:-1196752023</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
